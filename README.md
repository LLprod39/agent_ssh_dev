# SSH Agent ั LLM

ะะฒัะพะผะฐัะธะทะธัะพะฒะฐะฝะฝะฐั ัะธััะตะผะฐ ะดะปั ะฒัะฟะพะปะฝะตะฝะธั ะทะฐะดะฐั ะฝะฐ ัะดะฐะปะตะฝะฝัั ัะตัะฒะตัะฐั ัะตัะตะท SSH ั ะธัะฟะพะปัะทะพะฒะฐะฝะธะตะผ LLM ะดะปั ะฟะปะฐะฝะธัะพะฒะฐะฝะธั ะธ ะฒัะฟะพะปะฝะตะฝะธั ะบะพะผะฐะฝะด.

## ะะพะทะผะพะถะฝะพััะธ

- ๐ค **ะะฝะพะณะพััะพะฒะฝะตะฒะพะต ะฟะปะฐะฝะธัะพะฒะฐะฝะธะต** - ัะฐะทะฑะธะตะฝะธะต ะทะฐะดะฐั ะฝะฐ ะพัะฝะพะฒะฝัะต ัะฐะณะธ ะธ ะฟะพะดะทะฐะดะฐัะธ
- ๐ง **ะะฒัะพะผะฐัะธัะตัะบะฐั ะบะพััะตะบัะธั ะพัะธะฑะพะบ** - ัะธััะตะผะฐ ะฐะฒัะพะบะพััะตะบัะธะธ ั ะผะฝะพะถะตััะฒะตะฝะฝัะผะธ ัััะฐัะตะณะธัะผะธ
- ๐ **ะะตะทะพะฟะฐัะฝะพััั** - ะฟัะพะฒะตัะบะฐ ะทะฐะฟัะตัะตะฝะฝัั ะบะพะผะฐะฝะด ะธ ะฒะฐะปะธะดะฐัะธั
- ๐ **ะะพะฝะธัะพัะธะฝะณ** - ะดะตัะฐะปัะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต ะธ ะพััะตัั ะพ ะฒัะฟะพะปะฝะตะฝะธะธ
- ๐ฏ **Task Master ะธะฝัะตะณัะฐัะธั** - ัะปัััะตะฝะธะต ะฟัะพะผัะพะฒ ัะตัะตะท light-task-master
- ๐ **ะะดะตะผะฟะพัะตะฝัะฝะพััั** - ะฑะตะทะพะฟะฐัะฝะพะต ะฟะพะฒัะพัะฝะพะต ะฒัะฟะพะปะฝะตะฝะธะต ะทะฐะดะฐั ั ะฟัะพะฒะตัะบะฐะผะธ ัะพััะพัะฝะธั
- ๐ธ **ะกะฝะธะผะบะธ ัะพััะพัะฝะธั** - ัะพะทะดะฐะฝะธะต ะธ ะฒะพัััะฐะฝะพะฒะปะตะฝะธะต ัะพััะพัะฝะธะน ัะธััะตะผั
- โช **ะกะธััะตะผะฐ ะพัะบะฐัะฐ** - ะฐะฒัะพะผะฐัะธัะตัะบะธะน ะพัะบะฐั ะธะทะผะตะฝะตะฝะธะน ะฟัะธ ะพัะธะฑะบะฐั
- ๐ง **ะะพะดะดะตัะถะบะฐ ะผะฝะพะถะตััะฒะตะฝะฝัั LLM** - OpenAI GPT, Google Gemini, Anthropic Claude

## ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
โ   Task Master   โ    โ   Task Agent    โ    โ  Subtask Agent  โ
โ   Integration   โโโโโถโ  (ะะปะฐะฝะธัะพะฒะฐะฝะธะต) โโโโโถโ (ะะตัะฐะปะธะทะฐัะธั)   โ
โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
                                                       โ
                       โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
                       โ  Error Handler  โโโโโโ  Execution      โ
                       โ  (ะะฑัะฐะฑะพัะบะฐ)    โ    โ  Model          โ
                       โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ
                                                       โ
                                               โโโโโโโโโโโโโโโโโโโ
                                               โ  SSH Connector  โ
                                               โ  (ะัะฟะพะปะฝะตะฝะธะต)   โ
                                               โโโโโโโโโโโโโโโโโโโ
```

## ะฃััะฐะฝะพะฒะบะฐ

### ะขัะตะฑะพะฒะฐะฝะธั

- Python 3.9+
- Node.js 18+
- SSH ะดะพัััะฟ ะบ ัะตะปะตะฒัะผ ัะตัะฒะตัะฐะผ

### ะััััะฐั ัััะฐะฝะพะฒะบะฐ

```bash
# 1. ะะปะพะฝะธััะนัะต ัะตะฟะพะทะธัะพัะธะน
git clone <repository-url>
cd agent_ssh_dev

# 2. ะกะพะทะดะฐะนัะต ะฒะธัััะฐะปัะฝะพะต ะพะบััะถะตะฝะธะต Python
python -m venv venv
source venv/bin/activate  # Linux/Mac
# ะธะปะธ
venv\Scripts\activate     # Windows

# 3. ะฃััะฐะฝะพะฒะธัะต Python ะทะฐะฒะธัะธะผะพััะธ
pip install -r requirements.txt

# 4. ะฃััะฐะฝะพะฒะธัะต Node.js ะทะฐะฒะธัะธะผะพััะธ (ะดะปั Task Master)
npm install

# 5. ะะฝะธัะธะฐะปะธะทะธััะนัะต ะบะพะฝัะธะณััะฐัะธั
python ssh-agent init
```

### ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน

```bash
# Python ะทะฐะฒะธัะธะผะพััะธ
pip install -r requirements.txt

# Node.js ะทะฐะฒะธัะธะผะพััะธ (ะดะปั Task Master)
npm install
```

### ะะฐัััะพะนะบะฐ

1. ะกะบะพะฟะธััะนัะต ะฟัะธะผะตัั ะบะพะฝัะธะณััะฐัะธะธ:
```bash
cp config/server_config.yaml.example config/server_config.yaml
cp config/agent_config.yaml.example config/agent_config.yaml
```

2. ะะฐัััะพะนัะต ะฟะฐัะฐะผะตััั ัะตัะฒะตัะฐ ะฒ `config/server_config.yaml`
3. ะะฐัััะพะนัะต ะฟะฐัะฐะผะตััั ะฐะณะตะฝัะพะฒ ะฒ `config/agent_config.yaml`

## ะัะฟะพะปัะทะพะฒะฐะฝะธะต

### CLI ะะฝัะตััะตะนั

SSH Agent ะฟัะตะดะพััะฐะฒะปัะตั ะผะพัะฝัะน ะบะพะผะฐะฝะดะฝัะน ะธะฝัะตััะตะนั ะดะปั ัะดะพะฑะฝะพะน ัะฐะฑะพัั:

```bash
# ะะฝะธัะธะฐะปะธะทะฐัะธั ะบะพะฝัะธะณััะฐัะธะธ
ssh-agent init

# ะัะฟะพะปะฝะตะฝะธะต ะทะฐะดะฐัะธ
ssh-agent execute "ะฃััะฐะฝะพะฒะธัั nginx ะฝะฐ ัะตัะฒะตัะต"

# ะัะตะดะฒะฐัะธัะตะปัะฝัะน ะฟัะพัะผะพัั (dry-run)
ssh-agent execute "ะะฐัััะพะธัั SSL ัะตััะธัะธะบะฐั" --dry-run

# ะะฝัะตัะฐะบัะธะฒะฝัะน ัะตะถะธะผ
ssh-agent interactive

# ะะพะบะฐะท ััะฐัััะฐ
ssh-agent status

# ะะพะบะฐะท ะธััะพัะธะธ ะฒัะฟะพะปะฝะตะฝะธั
ssh-agent history

# ะฃะฟัะฐะฒะปะตะฝะธะต ะบะพะฝัะธะณััะฐัะธะตะน
ssh-agent config validate
```

### ะะฐะทะพะฒะพะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต (Python API)
```python
from agent_ssh_dev import SSHAgent

# ะะฝะธัะธะฐะปะธะทะฐัะธั ะฐะณะตะฝัะฐ
agent = SSHAgent(
    server_config="config/server_config.yaml",
    agent_config="config/agent_config.yaml"
)

# ะัะฟะพะปะฝะตะฝะธะต ะทะฐะดะฐัะธ
result = agent.execute_task("ะฃััะฐะฝะพะฒะธัั ะธ ะฝะฐัััะพะธัั PostgreSQL ะฝะฐ ัะตัะฒะตัะต")
print(result)
```

### CLI ะธัะฟะพะปัะทะพะฒะฐะฝะธะต

```bash
# ะัะฟะพะปะฝะตะฝะธะต ะทะฐะดะฐัะธ
ssh-agent execute "ะฃััะฐะฝะพะฒะธัั nginx"

# Dry-run ัะตะถะธะผ
ssh-agent execute "ะะฐัััะพะธัั SSL" --dry-run

# ะะฝัะตัะฐะบัะธะฒะฝัะน ัะตะถะธะผ
ssh-agent interactive
```

## ะัะพะฒะฐะนะดะตัั LLM

SSH Agent ะฟะพะดะดะตัะถะธะฒะฐะตั ะฝะตัะบะพะปัะบะพ ะฟัะพะฒะฐะนะดะตัะพะฒ LLM:

### OpenAI GPT
```yaml
llm:
  provider: "openai"
  api_key: "sk-..."
  model: "gpt-4"
  base_url: "https://api.openai.com/v1"
```

### Google Gemini
```yaml
llm:
  provider: "gemini"
  api_key: "AI..."
  model: "gemini-pro"
  base_url: "https://generativelanguage.googleapis.com/v1beta"
```

### ะะฐัััะพะนะบะฐ ะฟัะพะฒะฐะนะดะตัะฐ

1. **ะฃััะฐะฝะพะฒะธัะต ะทะฐะฒะธัะธะผะพััะธ**:
   ```bash
   # ะะปั OpenAI
   pip install openai>=1.0.0
   
   # ะะปั Gemini
   pip install google-generativeai>=0.3.0
   
   # ะะปั Anthropic
   pip install anthropic>=0.7.0
   ```

2. **ะะฐัััะพะนัะต ะบะพะฝัะธะณััะฐัะธั** ะฒ `config/agent_config.yaml`

3. **ะะพะปััะธัะต API ะบะปััะธ**:
   - OpenAI: [platform.openai.com](https://platform.openai.com/api-keys)
   - Gemini: [makersuite.google.com](https://makersuite.google.com/app/apikey)
   - Anthropic: [console.anthropic.com](https://console.anthropic.com/)

ะะพะดัะพะฑะฝะตะต ัะผ. [ะัะบะพะฒะพะดััะฒะพ ะฟะพ ะธะฝัะตะณัะฐัะธะธ Gemini](docs/gemini_integration_guide.md)

## ะะพะฝัะธะณััะฐัะธั

### server_config.yaml

```yaml
server:
  host: "example.com"
  port: 22
  username: "user"
  auth_method: "key"  # key, password
  key_path: "/path/to/private/key"
  timeout: 30
  os_type: "ubuntu"  # ubuntu, centos, debian
  forbidden_commands:
    - "rm -rf /"
    - "dd if=/dev/zero"
    - "mkfs"
```

### agent_config.yaml

```yaml
agents:
  taskmaster:
    enabled: true
    model: "gpt-4"
    temperature: 0.7
  
  task_agent:
    model: "gpt-4"
    temperature: 0.3
    max_steps: 10
  
  executor:
    max_retries_per_command: 2
    auto_correction_enabled: true
    dry_run_mode: false
```

## ะะฐะทัะฐะฑะพัะบะฐ

### ะฃััะฐะฝะพะฒะบะฐ ะดะปั ัะฐะทัะฐะฑะพัะบะธ

```bash
pip install -e ".[dev]"
```

### ะะฐะฟััะบ ัะตััะพะฒ

```bash
pytest
```

### ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต ะบะพะดะฐ

```bash
black src/
isort src/
```

## ะะดะตะผะฟะพัะตะฝัะฝะพััั

ะกะธััะตะผะฐ ะพะฑะตัะฟะตัะธะฒะฐะตั ะฑะตะทะพะฟะฐัะฝะพะต ะฟะพะฒัะพัะฝะพะต ะฒัะฟะพะปะฝะตะฝะธะต ะพะฟะตัะฐัะธะน ะฑะตะท ะฟะพะฑะพัะฝัั ัััะตะบัะพะฒ:

### ะัะฝะพะฒะฝัะต ะฒะพะทะผะพะถะฝะพััะธ

- **ะะตะฝะตัะฐัะธั ะธะดะตะผะฟะพัะตะฝัะฝัั ะบะพะผะฐะฝะด** - ะฐะฒัะพะผะฐัะธัะตัะบะพะต ะฟัะตะพะฑัะฐะทะพะฒะฐะฝะธะต ะบะพะผะฐะฝะด ะฒ ะฑะตะทะพะฟะฐัะฝัะต ะดะปั ะฟะพะฒัะพัะฝะพะณะพ ะฒัะฟะพะปะฝะตะฝะธั
- **ะัะพะฒะตัะบะธ ัะพััะพัะฝะธั** - ะฐะฝะฐะปะธะท ัะตะบััะตะณะพ ัะพััะพัะฝะธั ัะธััะตะผั ะฟะตัะตะด ะฒัะฟะพะปะฝะตะฝะธะตะผ ะบะพะผะฐะฝะด
- **ะกะฝะธะผะบะธ ัะพััะพัะฝะธั** - ัะพะทะดะฐะฝะธะต ัะพัะตะบ ะฒะพัััะฐะฝะพะฒะปะตะฝะธั ะดะปั ะพัะบะฐัะฐ ะธะทะผะตะฝะตะฝะธะน
- **ะกะธััะตะผะฐ ะพัะบะฐัะฐ** - ะฐะฒัะพะผะฐัะธัะตัะบะธะน ะพัะบะฐั ะบ ะฟัะตะดัะดััะตะผั ัะพััะพัะฝะธั ะฟัะธ ะพัะธะฑะบะฐั

### ะัะธะผะตัั ะธะดะตะผะฟะพัะตะฝัะฝัั ะบะพะผะฐะฝะด

```bash
# ะะฑััะฝะฐั ะบะพะผะฐะฝะดะฐ
apt-get install nginx

# ะะดะตะผะฟะพัะตะฝัะฝะฐั ะบะพะผะฐะฝะดะฐ
dpkg -l | grep -q '^ii  nginx' || apt-get install -y nginx
```

### ะัะฟะพะปัะทะพะฒะฐะฝะธะต

```python
from src.utils.idempotency_system import IdempotencySystem

# ะกะพะทะดะฐะฝะธะต ัะธััะตะผั ะธะดะตะผะฟะพัะตะฝัะฝะพััะธ
idempotency_system = IdempotencySystem(ssh_connector, config)

# ะกะพะทะดะฐะฝะธะต ัะฝะธะผะบะฐ ัะพััะพัะฝะธั
snapshot = idempotency_system.create_state_snapshot("task_001")

# ะะตะฝะตัะฐัะธั ะธะดะตะผะฟะพัะตะฝัะฝะพะน ะบะพะผะฐะฝะดั
cmd, checks = idempotency_system.generate_idempotent_command(
    "apt-get install nginx", "install_package", "nginx"
)

# ะัะพะฒะตัะบะฐ ะฝะตะพะฑัะพะดะธะผะพััะธ ะฒัะฟะพะปะฝะตะฝะธั
should_skip = idempotency_system.should_skip_command(cmd, checks)
```

ะะพะดัะพะฑะฝะตะต ัะผ. [ะะพะบัะผะตะฝัะฐัะธั ะฟะพ ะธะดะตะผะฟะพัะตะฝัะฝะพััะธ](docs/idempotency_system.md)

## ะะตะทะพะฟะฐัะฝะพััั

- โ ะัะพะฒะตัะบะฐ ะทะฐะฟัะตัะตะฝะฝัั ะบะพะผะฐะฝะด
- โ Dry-run ัะตะถะธะผ ะดะปั ะฟัะตะดะฒะฐัะธัะตะปัะฝะพะณะพ ะฟัะพัะผะพััะฐ
- โ ะะฐะปะธะดะฐัะธั ะบะพะผะฐะฝะด ะฟะตัะตะด ะฒัะฟะพะปะฝะตะฝะธะตะผ
- โ ะะตะทะพะฟะฐัะฝะพะต ััะฐะฝะตะฝะธะต ััะตัะฝัั ะดะฐะฝะฝัั
- โ ะะตัะฐะปัะฝะพะต ะปะพะณะธัะพะฒะฐะฝะธะต ะฒัะตั ะพะฟะตัะฐัะธะน
- โ ะะดะตะผะฟะพัะตะฝัะฝะพััั ะดะปั ะฑะตะทะพะฟะฐัะฝะพะณะพ ะฟะพะฒัะพัะฝะพะณะพ ะฒัะฟะพะปะฝะตะฝะธั

## ะะธัะตะฝะทะธั

MIT License

## ะะพะดะดะตัะถะบะฐ

ะะปั ะฒะพะฟัะพัะพะฒ ะธ ะฟัะตะดะปะพะถะตะฝะธะน ัะพะทะดะฐะนัะต issue ะฒ ัะตะฟะพะทะธัะพัะธะธ.
