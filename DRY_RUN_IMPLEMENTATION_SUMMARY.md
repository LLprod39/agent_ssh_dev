# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è Dry-Run –†–µ–∂–∏–º–∞ - –†–µ–∑—é–º–µ

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### ‚úÖ –®–∞–≥ 5.3: Dry-run —Ä–µ–∂–∏–º

–í—Å–µ –∑–∞–¥–∞—á–∏ –®–∞–≥–∞ 5.3 —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã:

1. **‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Ä–µ–∂–∏–º —Å–∏–º—É–ª—è—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**
   - –°–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ `DryRunSystem` –≤ `src/utils/dry_run_system.py`
   - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–∏–º—É–ª—è—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ —Å–∏—Å—Ç–µ–º—É
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

2. **‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–º–∞–Ω–¥**
   - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∞–Ω–∞–ª–∏–∑ –∫–æ–º–∞–Ω–¥ –ø–æ —Ç–∏–ø–∞–º –∏ —É—Ä–æ–≤–Ω—è–º —Ä–∏—Å–∫–∞
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞ –∫–æ–º–∞–Ω–¥
   - –°–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

3. **‚úÖ –°–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–ª–∞–Ω–æ–≤**
   - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–ª–∞–Ω–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–∞–Ω–¥
   - –°–æ–∑–¥–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ –ø–æ—Ä—è–¥–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

## –°–æ–∑–¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. –û—Å–Ω–æ–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ (`src/utils/dry_run_system.py`)
- **DryRunSystem** - –≥–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–∏—Å—Ç–µ–º—ã
- **CommandAnalysis** - –∞–Ω–∞–ª–∏–∑ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
- **PlanValidationResult** - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–ª–∞–Ω–æ–≤
- **DryRunResult** - —Ä–µ–∑—É–ª—å—Ç–∞—Ç dry-run –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- **RiskLevel** - —É—Ä–æ–≤–Ω–∏ —Ä–∏—Å–∫–∞ (LOW, MEDIUM, HIGH, CRITICAL)
- **CommandType** - —Ç–∏–ø—ã –∫–æ–º–∞–Ω–¥ (INSTALL, CONFIGURE, START_SERVICE, etc.)

### 2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Execution Model
- –î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã –≤ `ExecutionModel`:
  - `preview_execution()` - –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä
  - `validate_plan()` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–ª–∞–Ω–æ–≤
  - `generate_execution_report()` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤
  - `get_dry_run_summary()` - –∫—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞

### 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- –û–±–Ω–æ–≤–ª–µ–Ω `ExecutorConfig` —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ dry-run
- –î–æ–±–∞–≤–ª–µ–Ω –∫–ª–∞—Å—Å `DryRunSettings`
- –û–±–Ω–æ–≤–ª–µ–Ω —Ñ–∞–π–ª `config/agent_config.yaml`

### 4. –ü—Ä–∏–º–µ—Ä—ã –∏ —Ç–µ—Å—Ç—ã
- **examples/dry_run_example.py** - –ø–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **tests/test_utils/test_dry_run_system.py** - –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã
- **docs/dry_run_system_usage.md** - –ø–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üîç –ê–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥ –ø–æ —É—Ä–æ–≤–Ω—è–º —Ä–∏—Å–∫–∞
- –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–ø–∞—Å–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ (rm -rf, chmod 777, etc.)
- –ê–Ω–∞–ª–∏–∑ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º –∏ –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### üìä –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–ª–∞–Ω–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–ª–∞–Ω–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –í—ã—è–≤–ª–µ–Ω–∏–µ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –ê–Ω–∞–ª–∏–∑ –ø–æ—Ä—è–¥–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –∫–æ–º–∞–Ω–¥

### üìã –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤
- **–¢–µ–∫—Å—Ç–æ–≤—ã–µ –æ—Ç—á–µ—Ç—ã** - –¥–ª—è –∫–æ–Ω—Å–æ–ª–∏
- **JSON –æ—Ç—á–µ—Ç—ã** - –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- **Markdown –æ—Ç—á–µ—Ç—ã** - –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- –î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### ‚ö° –°–∏–º—É–ª—è—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∫–æ–º–∞–Ω–¥
- –û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—é

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```python
from src.utils.dry_run_system import DryRunSystem

dry_run_system = DryRunSystem()
commands = ["apt update", "apt install -y nginx"]
result = dry_run_system.simulate_execution(commands)

print(f"–†–∏—Å–∫: {result.risk_summary['overall_risk']}")
print(f"–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ: {result.risk_summary['requires_confirmation']}")
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Execution Model
```python
execution_model = ExecutionModel(config, ssh_connector)
preview_result = execution_model.preview_execution(context)
validation_result = execution_model.validate_plan(context)
report = execution_model.generate_execution_report(context, "text")
```

## –£—Ä–æ–≤–Ω–∏ —Ä–∏—Å–∫–∞

- **üü¢ LOW** - –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã (apt update, ls, cat)
- **üü° MEDIUM** - –£–º–µ—Ä–µ–Ω–Ω—ã–π —Ä–∏—Å–∫ (rm /tmp/test, systemctl stop)
- **üü† HIGH** - –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ (chmod 777, rm -rf /tmp)
- **üî¥ CRITICAL** - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Ä–∏—Å–∫ (rm -rf /, dd if=/dev/zero)

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```yaml
agents:
  executor:
    dry_run_mode: false
    dry_run_settings:
      enabled: true
      generate_reports: true
      report_formats: ["text", "json", "markdown"]
      validate_plans: true
      analyze_risks: true
      require_confirmation_for_high_risk: true
      log_simulations: true
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã:
- ‚úÖ –ë–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–∏–º—É–ª—è—Ü–∏–∏
- ‚úÖ –ê–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤ –∏ —Ç–∏–ø–æ–≤ –∫–æ–º–∞–Ω–¥
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–ª–∞–Ω–æ–≤
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Execution Model
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

Dry-run —Å–∏—Å—Ç–µ–º–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥
- –ê–Ω–∞–ª–∏–∑ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —Ä–∏—Å–∫–æ–≤
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –¥–ª—è –æ–ø–∞—Å–Ω—ã—Ö –∫–æ–º–∞–Ω–¥
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –í–∞–ª–∏–¥–∞—Ü–∏—é –ø–ª–∞–Ω–æ–≤ –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

Dry-run —Ä–µ–∂–∏–º –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤:
- CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–≠—Ç–∞–ø 7.1)
- –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–≠—Ç–∞–ø 7.2)
- –°–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (–≠—Ç–∞–ø 8.2)

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–®–∞–≥ 5.3 "Dry-run —Ä–µ–∂–∏–º" –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω. –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ production —Å—Ä–µ–¥–µ –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω—É—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é —Å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–º –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–º –∏ –∞–Ω–∞–ª–∏–∑–æ–º —Ä–∏—Å–∫–æ–≤.
